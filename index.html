<!DOCTYPE html>
<html>
<head>
  <title>Funny Story App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * {
      box-sizing: border-box;
      font-family: Arial, sans-serif;
    }
    body, html {
      margin: 0;
      padding: 0;
      background: #e8f0fe;
      color: #222;
    }
    #app {
      max-width: 600px;
      margin: 0 auto;
      padding: 20px;
    }
    button {
      padding: 10px;
      font-size: 16px;
      margin: 5px;
      border: none;
      background: #4285f4;
      color: white;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background: #3367d6;
    }
    input, textarea {
      width: 100%;
      margin-bottom: 10px;
      padding: 10px;
      font-size: 16px;
    }
    .story-entry {
      background: #fff;
      margin: 10px 0;
      padding: 10px;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div id="app">
    <h1>Funny Story App</h1>
    <textarea id="storyInput" placeholder="Write your story. Each line will be one page."></textarea>
    <input id="titleInput" placeholder="Title">
    <button onclick="saveStory()">Save Story</button>

    <h2>Saved Stories</h2>
    <div id="stories"></div>

    <div id="storyReader" class="hidden">
      <h2 id="storyTitle"></h2>
      <div id="storyPage"></div>
      <p id="pageCounter"></p>
      <button onclick="prevPage()">Previous</button>
      <button onclick="nextPage()">Next</button>
      <button onclick="closeStory()">Close</button>
    </div>
  </div>

  <script>
    let stories = JSON.parse(localStorage.getItem('funnyStories') || '[]');
    let currentPage = 0;
    let currentStory = null;

    const defaultStories = [
      {
        title: "Backflip Showdown",
        content: [
          "Jimmy Nallon hosts a show with Justin Bieber.",
          "They have a backflip competition.",
          "It's a tie after round 1.",
          "In round 2, Justin gets a score of 9.",
          "Jimmy needs a 10 to win.",
          "He lands weird on his ankle and falls off the stage!",
          "The show ends abruptly.",
          "News breaks that Jimmy is paralyzed.",
          "But it was all a prank!",
          "Everything was fake. The audience were actors. The End."
        ],
        isDefault: true
      },
      {
        title: "The Walk Home",
        content: [
          "Pablo was walking home when he heard a strange noise.",
          "He looked behind him but saw nothing.",
          "He heard it again, still nothing.",
          "He shouted, 'Is someone playing a prank on me?!'",
          "No response. He kept walking.",
          "He heard it again. Still nothing.",
          "The whole way home he kept hearing it.",
          "Until... he took off his shoes.",
          "The noise stopped.",
          "It was just his shoes squeaking. The end."
        ],
        isDefault: true
      }
    ];

    function sanitize(text) {
      return text.replace(/badword|crap|shit|damn|hell/gi, '****');
    }

    function saveStory() {
      const content = sanitize(document.getElementById('storyInput').value.trim());
      const title = sanitize(document.getElementById('titleInput').value.trim());
      if (!title || !content) return;
      const newStory = {
        title: title,
        content: content.split("\n").filter(Boolean),
        isDefault: false
      };
      stories.push(newStory);
      localStorage.setItem('funnyStories', JSON.stringify(stories));
      document.getElementById('storyInput').value = "";
      document.getElementById('titleInput').value = "";
      loadStories();
    }

    function deleteStory(index) {
      if (stories[index].isDefault) return;
      stories.splice(index, 1);
      localStorage.setItem('funnyStories', JSON.stringify(stories));
      loadStories();
    }

    function openStory(index) {
      currentStory = stories[index];
      currentPage = 0;
      document.getElementById('storyReader').classList.remove('hidden');
      document.getElementById('storyTitle').innerText = currentStory.title;
      updatePage();
    }

    function updatePage() {
      document.getElementById('storyPage').innerText = currentStory.content[currentPage];
      document.getElementById('pageCounter').innerText = `Page ${currentPage + 1} of ${currentStory.content.length}`;
    }

    function nextPage() {
      if (currentPage < currentStory.content.length - 1) {
        currentPage++;
        updatePage();
      }
    }

    function prevPage() {
      if (currentPage > 0) {
        currentPage--;
        updatePage();
      }
    }

    function closeStory() {
      document.getElementById('storyReader').classList.add('hidden');
      currentStory = null;
    }

    function loadStories() {
      const container = document.getElementById('stories');
      container.innerHTML = '';
      stories.forEach((story, i) => {
        const div = document.createElement('div');
        div.className = 'story-entry';
        div.innerHTML = `
          <strong>${story.title}</strong><br>
          <button onclick="openStory(${i})">Read</button>
          ${!story.isDefault ? `<button onclick="deleteStory(${i})">Delete</button>` : ''}
        `;
        container.appendChild(div);
      });
    }

    // Merge and load stories
    stories = [...defaultStories, ...stories.filter(s => !s.isDefault)];
    localStorage.setItem('funnyStories', JSON.stringify(stories));
    loadStories();
  </script>
</body>
</html>
